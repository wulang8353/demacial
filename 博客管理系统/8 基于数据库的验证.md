## 用户注册、登陆

**body-parser 中间件，专门处理http请求的数据**


https://github.com/expressjs/body-parser

* 通过模型类Model操作数据库，调用返回的构造函数
```
// api.js
...
var User = require('../models/User'); // 通过模型类操作数据库

...
// 用户名是否已经被注册了，如果数据库中已经存在和我们要注册的用户名同名的数据，表示该用户名已经被注册了
// 通过模型类，可以像操作对象一样的操作数据库
User.findOne({

    username: username  // 数据库查找数据

}).then(function( userInfo ) {  // 返回值是一个promise对象

    if ( userInfo ) {
        //表示数据库中有该记录
        responseData.code = 4;
        responseData.message = '用户名已经被注册了';
        res.json(responseData);
        return;
    }

    // 保存未被注册的用户信息到数据库中
    // 通过New一个User构造函数，操作对象一样的操作数据库
    var user = new User({
        username: username,  // 直接让其等于属性值
        password: password   // 直接让其等于属性值
    });
    return user.save();  // 保存到数据库,return返回promise对象

}).then(function(newUserInfo) {
    responseData.message = '注册成功';
    res.json(responseData);
    return;
});

```